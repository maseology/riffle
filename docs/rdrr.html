<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="M. Marchildon" />

<meta name="date" content="2021-01-06" />

<title>Regionally-distributed Runoff and Recharge model</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Riffle</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="rdrr.html">RDRR</a>
</li>
<li>
  <a href="Journal.html">Journal</a>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"><strong>Regionally-distributed Runoff and Recharge model</strong></h1>
<h3 class="subtitle"><em>development of the ORMGP water budget tool</em></h3>
<h4 class="author">M. Marchildon</h4>
<h4 class="date">January 06, 2021</h4>

</div>


<style type="text/css">
h1, .h1, h2, .h2, h3, .h3 {
    margin-top: 84px;
}
</style>
<hr />
<div id="itemized-summary" class="section level2">
<h2>Itemized Summary</h2>
<ul>
<li>model run from the hydrological water year 2010 (2009-10-01) through water year 2020.</li>
<li>Potential evaporation determined using the empirical wind functions of Penman (1948)</li>
<li>Rainfall was collected from capa</li>
<li>Snowmelt was collected from SNODAS</li>
<li>T, rh from MSC</li>
<li>12.1M x 50x50 m cells x 6-hourly ts x 10 years</li>
</ul>
</div>
<div id="executive-summary" class="section level2">
<h2>Executive Summary</h2>
<p>The model is physically based in that mass is conserved and it is not constrained to any particular timestep. Most parameters are common, percent impervious, conductivity of surficial soils, etc.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The following is a description of the water budget tool located on our website, hereinafter referred to as the “<em>model</em>”.</p>
</div>
<div id="model-structure" class="section level2">
<h2>Model Structure</h2>
<p>Runoff is conceptualized as being generated through the saturation excess (Dunne, 1975 CHECK) mechanism. Land area that has the capacity to retain water (through interception, soil retention, depression/rill storage, etc.) must be satisfied. The saturation excess mechanism is dependent on topography and it’s interaction with the groundwater system; thus the model is distributed (cell-based) and has an integrated (albeit conceptual) groundwater system.</p>
<p>Surface water-groundwater integration is viewed from the hydrologists’ perspective: areas where is the groundwater system limiting infiltration (shallow groundwater table) and even contributing to overland runoff (springs/seepage areas). As a model output, this can be quantified as a net groundwater exchange field (groundwater recharge and discharge)</p>
<p>dunnian processes.</p>
<p>The purpose of the model is to have a</p>
<p>The purpose of the model is to account for the water balance estimate the spatial and temporal distribution of water on the landscape.</p>
<p>The basis of the model is that topography is paramount to the lateral movement of water yielding runoff. The model is deemed regional, in that it covers a large areal extent, yet is kept to a fine resolution to ensure that observed geomorphic flow patterns are represented in the model.</p>
<div id="time-stepping" class="section level3">
<h3>Time stepping</h3>
<p>The time step of the model has been set to 6 hour steps on 00:00 UTC, yielding the local time steps of 01:00, 07:00, 13:00, and 19:00 EST. This step is chosen as it matches the received precipitation dataset described below.</p>
</div>
<div id="digital-elevation-model" class="section level3">
<h3>Digital Elevation Model</h3>
<p>The Greater Toronto Area 2002 DEM (OMNRF, 2015) was re-sampled to the model’s 50x50m grid cell resolution. Surface depressions were removed using Wang and Liu (2006) and flat regions were corrected using Martz (1997).</p>
<p>Drainage directions and flowpaths of the now “hydrologically correct” DEM were were assigned based on the direction of steepest decent (D8).Cell gradients (<span class="math inline">\(b\)</span>) and slope aspects were calculated based on a 9-cell planar interpolation routine. The unit contributing area <span class="math inline">\(a=A/w\)</span> topographic wetness index <span class="math inline">\(ln\frac{a}{\tan b}\)</span> (Beven and Kirkby, 1979–CHECK) were computed for every cell.</p>
</div>
<div id="sub-basins" class="section level3">
<h3>Sub-basins</h3>
<p>The 30,000 km² model area has been sub divided into 2,813 approximately 10 km² sub-basins. Within these sub-basins: 1. Meteorological forcings from external sources are aggregated applied uniformly within the sub-basin (via a pre-processing routine); and 1. Local shallow water response is assumed to act uniformly (the shallow subsurface catchment area).</p>
<div class="figure" style="text-align: center">
<img src="fig/fig-sws1.png" alt="2,813 10km² subwatersheds delineated within the ORMGP jurisdicton." width="75%" />
<p class="caption">
2,813 10km² subwatersheds delineated within the ORMGP jurisdicton.
</p>
</div>
<!-- <center> -->
<!-- ![sws](fig/fig-sws1.png) -->
<!-- </center> -->
</div>
<div id="parameterization" class="section level3">
<h3>Parameterization</h3>
<p>Although a distributed model, the procedures applied at the cell scale are quite parsimonious. There is no separate treatment of interception, depression storage, nor soil water retention, rather it is assumed that these processes respond to environmental factors (e.g., evaporation) in parallel and thus can be treated in bulk.</p>
<p>From the top down perspective, viewing some 12.1 million 50x50m cells covering 30,000 km², it seems rather overcomplicated (possibly frivolous) to account water any more than to total mass present at any particular (lateral) location.</p>
<div id="global-parameters" class="section level4">
<h4>Global parameters</h4>
<p>Cells with a contributing area (<span class="math inline">\(A\)</span>) greater than 1 km² are deemed “stream cells” in which additional sources include groundwater discharge to streams.</p>
</div>
<div id="sub-basin-parameters" class="section level4">
<h4>Sub-basin parameters</h4>
<p>Groundwater processes in the model are conceptualized at the sub-basin scale and so much of the groundwater parameterization is implimented here.</p>
</div>
<div id="cell-based-parameters" class="section level4">
<h4>Cell-based parameters</h4>
<p>Each cell is classified according to (i) surficial geology and (ii) land use mapping where each class is parameterized independently. “Look-up tables” are used to distribute model parameters accordin to their classification.</p>
<div id="parameters" class="section level5">
<h5>Parameters:</h5>
<ul>
<li>impervious fraction</li>
<li>retention/storage capacity</li>
<li>depression storage</li>
<li>percolation rates</li>
</ul>
</div>
</div>
</div>
<div id="inputs" class="section level3">
<h3>Inputs</h3>
<p>The model’s structure is defined rather simply by at least 5 raster data sets. Given these data, the model’s pre-processor will generate additional information based on these data:</p>
<ol style="list-style-type: decimal">
<li>digital elevation model</li>
<li>land use index (with parameter lookup table)</li>
<li>surficial geology index (with parameter lookup table)</li>
<li></li>
</ol>
</div>
</div>
<div id="model-variables" class="section level2">
<h2>Model Variables</h2>
<p>One goal set for the model design was to leverage contemporary gridded data sets available from a variety of open and public sources. Products known as “<em>data re-analysis products</em>” or “<em>data-assimilation products</em>” attempt to merge meteorological information from a variety of sources, whether they be ground (station) measurements, remote sensing observations (e.g., radar, satellite, etc.), and archived near-cast weather model outputs. When combined, the gridded data resemble the spatial distribution of meteorological forcings unlike what can be accomplished through standard interpolation practices using point measurements (e.g., thiessen polygons, inverse distance weighting, etc.).</p>
<p>An advantage to the data-assimilation products is that it removes the modeller from needing to model certain processes explicitly. Here, for example, the model does not account for a snowpack, rather inputs to the model include snowmelt derrived from SNODAS.</p>
<p>The extent of the model combined with the resolution of the prosesses simulated lends itself best viewed from a top-down perspective (REF). This allows for model simplification by which many of the layered water stores (i.e., interception, deptression, soil, etc.) may be handled procedurally as one unit. Viewing the model domain in it’s 30,000 km² extents,one can imagine how difficult it would be to discern any verticle detail.</p>
<div id="model-input-data-processing" class="section level3">
<h3>Model Input Data Processing</h3>
<p>Meteorological data aquisiton, management, aggregation and interpolation was accomplished using <a href="https://www.deltares.nl/en/software/flood-forecasting-system-delft-fews-2/">Delft-FEWS</a> (ver.2019.02 build.39845) a flood forecasting system offered (at no cost, only license agreement) by <a href="https://www.deltares.nl/en/">Deltares</a>. Configuration files for the Delft-FEWS system build can be found here: BLAH.</p>
<p>Climate forcing data required by the model are atmospheric yield and potential evaporation on a 6-hourly timestep. Atmospheric yield is her defined as water added to land surface in its mobile (read: liquid) form. Additional processing performed on the data exported from Delft-FEWS is described below.</p>
<div id="data-sets" class="section level4">
<h4>Data sets:</h4>
<p>Forcings data to the model processed by FEWS include:</p>
<ol style="list-style-type: decimal">
<li><a href="https://weather.gc.ca/grib/grib2_RDPA_ps10km_e.html">CaPA-RDPA</a> 10/15km gridded precipitation fields, yielding 6-hourly precipiation totals, aquired from <a href="https://caspar-data.ca/">CaSPAr</a>;</li>
<li><a href="https://nsidc.org/data/g02158">SNODAS</a> (NOHRSC, 2004) ~1km gridded 24-hour (UTC 06-06) snowmelt totals; and</li>
<li>Meteorological Service of Canada (MSC) hourly mean temperature and pressure accessed <a href="http://climate.weather.gc.ca/historical_data/search_historic_data_e.html">here</a>.</li>
</ol>
</div>
<div id="transformations" class="section level4">
<h4>Transformations</h4>
<p>The time step of the model was set to the 6-hour time step offered with the CaPA-RDPA data. Hourly temperatures were</p>
</div>
<div id="time-step-temporal-scale" class="section level4">
<h4>Time step (temporal scale)</h4>
<p>The time step of the model has been set to 6 hour steps. All other data sets have been either aggregated or disaggregated to match this temporal scale.</p>
<p>The aquired data come in a variety of time steps…</p>
<div class="figure" style="text-align: center">
<img src="fig/met_timeline.svg" alt="discrepancy in data time resolution." width="75%" />
<p class="caption">
discrepancy in data time resolution.
</p>
</div>
</div>
<div id="interpolation-spatial-scale" class="section level4">
<h4>Interpolation (spatial scale)</h4>
<p>Once transformed to the set time step, both scalar (i.e., point) data and gridded data are then interpolated to the 10 km² sub-watersheds. Given that each watershed contains</p>
</div>
</div>
<div id="atmospheric-yield" class="section level3">
<h3>Atmospheric Yield</h3>
<div id="precipitation-and-snowmelt" class="section level4">
<h4>Precipitation and Snowmelt</h4>
<p>CaSPAr</p>
<p>… 10 km resolution, compare that to the XX average spacing among operational meteorological stations.</p>
<p>snodas … can avoid the need to model snowmelt explicitly, and leverage online resources.</p>
<!-- The daily SNODAS time series was then disaggregated to the 6-hourly-UTC time stepping scheme described above using the Delft-FEWS transformation [Disaggregation: MeanToMean](https://publicwiki.deltares.nl/display/FEWSDOC/meanToMean). -->
<p>The precipitation and snowmelt time-series was then projected onto the model sub-watersheds using the transformation: <a href="https://publicwiki.deltares.nl/display/FEWSDOC/InterpolationSpatialInverseDistance">InverseDistance</a>.</p>
</div>
<div id="atmospheric-yield-1" class="section level4">
<h4>Atmospheric Yield</h4>
<p>The data collected include total precipitation and snowmelt. Summing the two together would double count precipitation fallen as snow; the model, however does not account for snow, rather it relies on snowmelt as a forcing. Precipition is parsed into rainfall and snowfall on the basis of a critical temperature (<span class="math inline">\(T_\text{crit}\)</span>):</p>
<p><span class="math display">\[
\text{Rainfall}=
\begin{cases}
\text{Precipitation}, &amp; T&gt;T_\text{crit}\\
0 &amp; \text{otherwise},
\end{cases}
\]</span> <span class="math display">\[
\text{Snowfall}=
\begin{cases}
\text{Precipitation}, &amp; T\leq T_\text{crit}\\
0 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
<!-- $$ -->
<!-- \begin{split} -->
<!-- \text{Rainfall} &= -->
<!-- \begin{cases} -->
<!-- \text{Precipitation}, & T>T_\text{crit}\\ -->
<!-- 0 & \text{otherwise}, -->
<!-- \end{cases} \\ -->
<!-- \text{Snowfall} &= -->
<!-- \begin{cases} -->
<!-- \text{Precipitation}, & T\leq T_\text{crit}\\ -->
<!-- 0 & \text{otherwise}. -->
<!-- \end{cases} -->
<!-- \end{split} -->
<!-- $$ -->
<p>An optimization routine is employed to determine <span class="math inline">\(T_\text{crit}\)</span> such that annual average snowfall is equal to annual average snowmelt to ensure minimal deviation from total precipitation. Furthermore, snowmelt, which is aquired at a daily timestep that represents the <em>“total of 24 per hour melt rates, 06:00 UTC-06:00 UTC … integrated for the previous 24 hours, giving daily totals”</em> (NOHRSC, 2004), is disaggregated to a 6-hourly time step based on the following rules:</p>
<ol style="list-style-type: decimal">
<li>If any timesteps has temperatures greater than 10°C, snowmelt is equally divided amongst them;</li>
<li>The first time step having 6-hour rainfall <span class="math inline">\(\geq\)</span> 5 mm, all melt is assumed to occur during this event;</li>
<li>If any timesteps within 06:00-06:00 UTC has rainfall greater than 1 mm, snowmelt is proportionned according to (and added with) rainfall;</li>
<li>If any timesteps has temperatures greater than 0°C, snowmelt is equally divided amongst them; otherwise</li>
<li>Snowmelt is equally divided among the 2 daytime time steps (12:00-00:00 UTC—07:00-19:00 EST).</li>
</ol>
<p>The final product, a single forcing termed “Atmospheric Yield” is inputted in the model.</p>
<p><span class="math display">\[\text{Rainfall} + \text{Snowmelt} = \textit{Atmospheric Yield}\]</span></p>
<p>The aim of the model design is to simulatneously reduce the amount of computational processes and leverage near-realtime data assimilation products. It is recognized from a hydrological model design perspective, that the dynamic processes that dictate the spatial distribution of watershed moisture is only affected by atmopheric yeild, that is water sourced from the atmosphere in liquid form.</p>
<!-- ### Temperature, Pressure, Humidity and Wind Speed -->
</div>
</div>
<div id="atmospheric-demand-e_a" class="section level3">
<h3>Atmospheric Demand <span class="math inline">\((E_a)\)</span></h3>
<div id="t_a-p_a-textrh-and-u" class="section level4">
<h4><span class="math inline">\(T_a\)</span>, <span class="math inline">\(P_a\)</span>, <span class="math inline">\(\text{rh}\)</span> and <span class="math inline">\(u\)</span></h4>
<p>Historical hourly measurements of air temperature, pressure, relative humidity and windspeed were retrieved from the ECCC website: <a href="https://climate.weather.gc.ca/historical_data/search_historic_data_e.html" class="uri">https://climate.weather.gc.ca/historical_data/search_historic_data_e.html</a>. In total, 46 stations with varying periods of record length and quality were collected.</p>
<p>The hourly time-series collected from each station was then aggregated to the 6-hourly-UTC time stepping scheme described above. Aggregation of all metrics was accomplished using the Delft-FEWS transformation <a href="https://publicwiki.deltares.nl/display/FEWSDOC/Aggregation+MeanToMean">“Aggregation: MeanToMean”</a>.</p>
<p>The 6-hourly-UTC time-series was then projected onto the model sub-watersheds using the transformation <a href="https://publicwiki.deltares.nl/display/FEWSDOC/InterpolationSpatialInverseDistance">“InterpolationSpatial: InverseDistance”</a>.</p>
<p>Model elevations range from 75-400 masl and orographic effects were deemed negligible beyond the spatial distribution meteorological stations.</p>
</div>
<div id="atmospheric-demand" class="section level4">
<h4>Atmospheric Demand</h4>
<p>The model considers the greater role the atmosphere has on its 30,000 km² extent. The atmosphere, taking a top-down perspective, requires consideration of PBL (Oke) as it reprensents the barrier from which mass must transfer when surface evaporation is captured by the atmosphere. This is particularily so when considering mass transfer over rough surfaces, where surface evaporation becomes coupled with advective (vapour deficit) flux through the PBL (surf clim can).</p>
<p>This is evident when relating pan evaporation to strictly aerodynamic variables temperature and humidity, integrated at the 6-hourly timestep. For instance, using the advective term [kg/m²/s] of Penman (1948) is:</p>
<p><span class="math display">\[
E_a=\rho_a \frac{\varepsilon}{p_a} d_a \cdot f(u)
\]</span></p>
<p>where <span class="math inline">\(d_a=(1-rh)e_s\)</span>, <span class="math inline">\(e_s \propto T_a\)</span> and the wind-function <span class="math inline">\(f(u)=au^b\)</span> [m/s] can safely reduced to an empirical form:</p>
<p><span class="math display">\[
E_a=7.46\times 10^{-9} \cdot au^b d_a
\]</span> where <span class="math inline">\(E_a\)</span> is now given in [m/s]. This is the power form of open water evaporation <span class="math inline">\((E_o)\)</span> used by Penman (1948). It is worth noting that this is modified from Penman (1948) in that it is assumed <span class="math inline">\(T_s \propto T_a\)</span>, that is the relationship between surface temperature and air temperature is captured in this empirical form.</p>
<!-- In addition to the above "Power" form, Penman (1948) also offers the the most common (linear) form: -->
<!-- $$ -->
<!-- E_a=a(1+bu) d_a -->
<!-- $$ -->
<!-- However, this did not perform as well as well as the power form. Either form is dependent on temperature and horizontal wind speed. -->
<p>For not it’s simplicity, the power law does perform well against observation. 24,641 data-days from 17 MSC daily pan evaporation stations were gathered for validatation. With <span class="math inline">\(u\)</span> [m/s] and <span class="math inline">\(d_a\)</span> [Pa], <span class="math inline">\(a=0.009\)</span> and <span class="math inline">\(b=0.26\)</span> resulted in a global Kling-Gupta (2008) efficiency of 0.66 and 0.86 for daily and monthly pan evaporation estimation, respectively.</p>
<div class="figure" style="text-align: center">
<img src="fig/4937_daily.svg" alt="Simlutated daily evaporation (using the above equation) against observed pan evaporation." width="75%" />
<p class="caption">
Simlutated daily evaporation (using the above equation) against observed pan evaporation.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="fig/4937_mscatter.svg" alt="Monthly totals, scatter plot. Red line is the 1:1 line" width="75%" />
<p class="caption">
Monthly totals, scatter plot. Red line is the 1:1 line
</p>
</div>
<div class="figure" style="text-align: center">
<img src="fig/4937_mts.svg" alt="Monthly totals, timeseries. (Note: shown here are consequtive months, only December-March are not included.)" width="75%" />
<p class="caption">
Monthly totals, timeseries. (Note: shown here are consequtive months, only December-March are not included.)
</p>
</div>
</div>
</div>
</div>
<div id="model-proceedures" class="section level2">
<h2>Model Proceedures</h2>
<div id="shallow-groundwater-model" class="section level3">
<h3>Shallow groundwater model</h3>
<p>Typically, the handling of groundwater in rainfall-runoff models involves the use of a groundwater storage reservoir with a linear/exponential decay function. When calibrating these models to long-term stream flow records, this model structure can be quite successful at matching baseflow recession. Given its success and it relative simplicity, the linear decay groundwater storage model is widely used and preferred for model calibration to stream flow gauging stations. However, implied in the linear decay groundwater storage model is the assumption that groundwater recharge is unidirectional and uniformly distributed basin-wide, or, at most, among common surficial material types. Consequently, catchment topography is neglected, which has a large role in distributing recharge, both in terms of focused recharge at overland flow convergence points and rejected recharge at low-lying areas where the groundwater table is close to, at, or above ground surface. For the purpose of this model, which is primarily intended for distributed recharge estimation, the linear decay groundwater storage model on its own will not suffice.</p>
<p>The groundwater model structure employed here follows the TOPMODEL structure of Beven and Kirkby (1979). TOPMODEL employs a distribution function that projects local soil water deficits at surface from a lumped groundwater reservoir. The distribution function is referred to as the “soil-topologic index” (Beven, 1986) that considers distributed surficial material properties, topography and upslope contributing areas. TOPMODEL does not explicitly model integrated groundwater/surface water processes, however it does provide the ability, albeit an indirect one, to include the influence of near-surface watertables distributed over the surface. Most importantly, low-lying areas close to drainage features will be prevented from accepting recharge resulting in saturated overland flow conditions.</p>
<p>Assumptions to TOPMODEL are that the groundwater reservoir is lumped meaning it is equivalently and instantaneously connected to all locations of the catchment constrained by topographic divides. This assumption also implies that recharge computed over a watershed is uniformly and instantaneously distributed to the water table. The groundwater reservoir is thought to be a shallow, single-layered, unconfined aquifer whose hydraulic gradient can be approximated by local surface slope.</p>
<p>Furthermore, lateral (downslope) transmissivity (<span class="math inline">\(T\)</span>) is assumed to scale exponentially with local soil moisture deficit (<span class="math inline">\(D\)</span>) or depth to the watertable (<span class="math inline">\(z_\text{wt}\)</span>) by:</p>
<p><span class="math display">\[
    T = T_o\exp{\left(\frac{-D}{m}\right)} = T_o\exp{\left(\frac{-\phi z_\text{wt}}{m}\right)},  
\]</span></p>
<p>where <span class="math inline">\(T_o=wK_\text{sat}\)</span> is the saturated lateral transmissivity perpendicular to an isopotential contour of unit length (<span class="math inline">\(w\)</span>) [m<span class="math inline">\(^2\)</span>/s] that occurs when no soil moisture deficit exists (i.e., <span class="math inline">\(D=0\)</span>), <span class="math inline">\(\phi\)</span> is effective porosity, and <span class="math inline">\(m\)</span> is a scaling factor [m]. Consequently, recharge computed in the distributed sense is aggregated when added to the lumped reservoir, yet discharge to surface remains distributed according to the soil-topographic index. For additional discussion on theory and assumptions, please refer to Beven etal (1995), Ambroise etal, (1996) and Beven (2012).</p>
<p>At the regional scale, multiple TOPMODEL reservoirs have been established to represent groundwater dynamics in sub-catchments (or groundwatersheds) of a pre-specified threshold area, here set to 10 km<span class="math inline">\(^2\)</span>. Groundwater discharge estimates from each TOPMODEL reservoir instantaneously contributes lateral discharge to stream channel cells within every sub-catchment according to Darcy’s law:</p>
<p><span class="math display">\[
    q = T\tan\beta = T_o\tan\beta\cdot e^{\left(\frac{-D}{m}\right)},
\]</span></p>
<p>where <span class="math inline">\(q\)</span> is interpreted here as groundwater discharge per unit length of stream [m<span class="math inline">\(^2\)</span>/s], and <span class="math inline">\(\tan\beta\)</span> is the surface slope angle. The sub-surface storage deficit (<span class="math inline">\(D_i\)</span>) at some location <span class="math inline">\(i\)</span> is determined using the distribution function:</p>
<p><span class="math display">\[
    D_i = \overline{D} + m \left[\gamma - \ln\left(\frac{a}{T_o \tan \beta}\right)_i\right],
\]</span></p>
<p>where <span class="math inline">\(a\)</span> is the unit contributing area to cell <span class="math inline">\(i\)</span> [m], defined here as the total contributing area to cell <span class="math inline">\(i\)</span> divided by the cell’s width <span class="math inline">\(w\)</span>. The expression <span class="math inline">\(\zeta_i=\ln(a/T_o \tan \beta)_i\)</span> is the so-called soil-topologic index of cell <span class="math inline">\(i\)</span>. <span class="math inline">\(\gamma\)</span> is the catchment average soil-topologic index and is determined by:</p>
<p><span class="math display">\[
    \gamma = \frac{1}{A}\sum_i A_i\zeta_i,
\]</span></p>
<p>where <span class="math inline">\(A\)</span> and <span class="math inline">\(A_i\)</span> is the sub-watershed and computational element (i.e., cell <span class="math inline">\(i\)</span>) areas, respectively. Rearranging the terms, keeping non-variable terms on the <span class="math inline">\(RHS\)</span>:</p>
<p><span class="math display">\[
  \delta D_i=D_i-\overline{D}=m\left(\gamma - \zeta_i\right)
\]</span> where <span class="math inline">\(\delta D_i\)</span> is the groundwater deficit relative to the regional mean. From this, at any time <span class="math inline">\(t\)</span>, the local deficit is thus: <span class="math display">\[
 D_{i,t} = \delta D_i+\overline{D}_t
\]</span> and basin-wide average moisture deficit is updated at time <span class="math inline">\(t\)</span> by:</p>
<p><span class="math display">\[
    \overline{D}_t = \frac{1}{A}\sum_i A_i D_i - G_{t-1} + B_{t-1},
\]</span></p>
<p>where <span class="math inline">\(G_{t-1}\)</span> is the total sub-watershed-wide groundwater recharge computed during the previous time step [m] and <span class="math inline">\(B_{t-1}\)</span> is the normalized groundwater discharge to streams computed during the previous time step [m]. The volumetric rate of groundwater discharge to streams <span class="math inline">\(Q_b\)</span> [m<span class="math inline">\(^3\)</span>/s] is given by:</p>
<p><span class="math display">\[
    Q_b = \frac{A\cdot B}{\Delta t} = \sum_{i=1}^Ml_iq_i, \qquad i \in \text{streams}
\]</span></p>
<p>and <span class="math inline">\(l_i\)</span> is length of channel in stream cell <span class="math inline">\(i\)</span>, here assumed constant and equivalent to the uniform cell width (<span class="math inline">\(w\)</span>) times a sinuosity factor (<span class="math inline">\(\Omega\)</span>), <span class="math inline">\(\Delta t\)</span> is the model time step and <span class="math inline">\(M\)</span> is the total number of model cells containing mapped streams within the sub-watershed. For every stream cell, groundwater flux to stream cells <span class="math inline">\(h_b\)</span> [m/s] at time <span class="math inline">\(t\)</span> is given by:</p>
<p><span class="math display">\[
  h_{b,i}=\frac{l_iq_i}{A_i}=Q_o\exp\left(\frac{D_\text{inc}-D}{m}\right) \qquad i \in \text{streams}
\]</span> where discharge to stream cell <span class="math inline">\(i\)</span> at saturated conditions <span class="math inline">\((D_\text{inc}-D=0)\)</span>:</p>
<p><span class="math display">\[
  Q_o=\Omega\cdot \frac{T_o\tan\beta}{w}
\]</span></p>
<p>and thus basin-wide groundwater discharge to streams:</p>
<p><span class="math display">\[
  B = \Delta t \sum_{i=1}^M h_{b,i}
\]</span></p>
<p>where <span class="math inline">\(D_\text{inc}\)</span> is an offset, meant to accomodate the degree of channel incision (i.e., the difference between channel elevation and cell elevation).</p>
<p>It should be noted that as a whole, this formulation behaves quite similar to the linear decay groundwater storage model, except here, TOPMODEL allows for an approximation of spatial soil moisture distribution, which will, in turn, determine spatial recharge patterns, as surplus condition (<span class="math inline">\(D_i\leq 0\)</span>) will prevent recharge from occurring at cell <span class="math inline">\(i\)</span>.</p>
<p>Initial watershed average soil moisture deficit is determined from streamflow records, re-arranging Beven (2012):</p>
<p><span class="math display">\[
    \overline{D}_{t=0} = -m\left[\gamma +\ln\left(\frac{Q_{t=0}}{A}\right)\right],
\]</span></p>
<p>where <span class="math inline">\(Q_{t=0}\)</span> is the measured stream flow known at the beginning of the model run. The parameter <span class="math inline">\(m\)</span> can be pre-determined from baseflow recession analysis (Beven etal, 1995; Beven, 2012).</p>
<p>Although plausible (and argued for), TOPMODEL can be allowed to have negative soil moisture deficits (i.e., <span class="math inline">\(D_i&lt;0\)</span>), meaning that water has ponded and overland flow is being considered. For the current model, ponded water and overland flow is being handled by the explicit soil moisture accounting (SMA) system and the lateral shallow water movement module discussed below. Conditions where <span class="math inline">\(D_i&lt;0\)</span> for any computational element will have the excess water (<span class="math inline">\(x\)</span>) removed and added to the SMA system and <span class="math inline">\(D_i\)</span> will be set to zero. Under these conditions, no recharge will occur at this cell. This exchange, in addition to groundwater discharge to streams, repesents the distributed interaction the groundwater system has on the surface. Given cell-based recharge (<span class="math inline">\(g\)</span>) computed by the SMA, basin recharge <span class="math inline">\(G\)</span> is updated to determine net grounwater exchange:</p>
<p><span class="math display">\[
  G_{t+1} = G_i+\sum_i(g-x)_i
\]</span></p>
</div>
<div id="lateral-water-movement" class="section level3">
<h3>Lateral water movement</h3>
<div id="and-soil-moisture-accounting-scheme" class="section level4">
<h4>…and soil moisture accounting scheme</h4>
<p>Each model cell consists of a retention reservoir <span class="math inline">\(S_h\)</span> (where water has the potential to drain) and a detention reservoir <span class="math inline">\(S_k\)</span> (where water is held locally); both with a prefined capacity and succeptable to evaporation loss. In addition, any number of cells can be grouped which share a semi-infinite conceptual groundwater store (<span class="math inline">\(S_g\)</span>).</p>
<p>Although conceptual, storage capacities may be related to common hydrologic concepts, for instance:</p>
<p><span class="math display">\[
  S_h=(\phi-\theta_\text{fc}) z_\text{ext}
\]</span> and</p>
<p><span class="math display">\[
  S_k=\theta_\text{fc} z_\text{ext}+f_\text{imp} h_\text{dep}+f_\text{can}\cdot I_\text{can}\cdot\text{LAI}
\]</span> where <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\theta_\text{fc}\)</span> are the water contents at saturation (porosity) and field capacity, respectively; <span class="math inline">\(f_\text{imp}\)</span> and <span class="math inline">\(f_\text{can}\)</span> are the fractional cell coverage of impervious area and tree canopy, respectively; <span class="math inline">\(h_\text{dep}\)</span> and <span class="math inline">\(I_\text{can}\)</span> are the capacities of impervious depression and interception stores, respectively; <span class="math inline">\(\text{LAI}\)</span> is the leaf area index and <span class="math inline">\(z_\text{ext}\)</span> is the extinction depth (i.e., the depth of which evaporative loss becomes negligeable). Change in detention storage at any time is defined by:</p>
<p><span class="math display">\[
    \Delta S_k=k_\text{in}+f_h+h_b\Delta t-\left(a_k+f_k+k_\text{out}\right),
\]</span></p>
<p>where <span class="math inline">\(k = q\frac{\Delta t}{w}\)</span> is the volumetric discharge in (<span class="math inline">\(_\text{in}\)</span>) and out (<span class="math inline">\(_\text{out}\)</span>) of the computational element, <span class="math inline">\(x\)</span> is the excess runoff (i.e., saturated excess) casued by a high watertable, and <span class="math inline">\(f_k\)</span> is the volume of mobile storage infiltrating the soil zone; all units are [m]. (note that groundwater discharge to streams—<span class="math inline">\(h_b\Delta t\)</span>—only occurs at stream cells an is only a gaining term.) Also note that <span class="math inline">\(k_\text{out}\)</span> only occurs when water stored in <span class="math inline">\(S_k\)</span> exceeds its capacity.</p>
<p>Change in retention storage [m]:</p>
<p><span class="math display">\[
    \Delta S_h = y+f_k+x-\left(a_h+f_h+g\right),
\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the atmospheric yield (rainfall + snowmelt), <span class="math inline">\(x\)</span> is groundwater infiltration into the soil zone from a high watertable, <span class="math inline">\(a\)</span> is evapotranspiration, and <span class="math inline">\(g\)</span> is recharge.</p>
<p>and change in groundwater storage [m] (i.e., Net Groundwater Exchange—positive: recharge; negative: discharge):</p>
<p><span class="math display">\[
    \Delta S_g = g-\left(x+h_b\Delta t\right).
\]</span></p>
<p>The overall water balance, with <span class="math inline">\(a=a_h+a_k\)</span>, over each CE is then given by:</p>
<p><span class="math display">\[
    \Delta S_k+\Delta S_h+\Delta S_g=y+k_\text{in}-\left(a+k_\text{out}\right).
\]</span></p>
<div class="figure" style="text-align: center">
<img src="fig/sma1.svg" alt="conceptual soil moisture accounting scheme." width="65%" />
<p class="caption">
conceptual soil moisture accounting scheme.
</p>
</div>
</div>
<div id="overland-flow" class="section level4">
<h4>overland flow</h4>
<p>Laterally moving water leaving the cell <span class="math inline">\(k_\text{out}\)</span> is corrected (primarily) based on landsurface slope and roughness. Water leaving a cell can only be directed to a single cell, but any cell can recieve from multiple cells. A “cascade factor”, <span class="math inline">\(f_\text{casc}=f(\text{slope},\text{roughness},\text{etc.})\)</span>, <span class="math inline">\(0\leq f_\text{casc} \leq 1\)</span>, is applied to the current volume stored in the mobile store (in the form of a linear reservoir):</p>
<p><span class="math display">\[
  k_\text{out}=f_\text{casc}S_k^+,
\]</span> where <span class="math inline">\(S_k^+&gt;0\)</span> is water in the detention store in excess of the store’s capacity, and:</p>
<p><span class="math display">\[
  f_\text{casc}=1-\exp\left(-a\frac{\beta^2}{r^2}\right),
\]</span></p>
<p>where <span class="math inline">\(\beta\)</span> is land surface gradient, <span class="math inline">\(r\)</span> is called the “range” (note that the above equation is identical to the Gaussian variogram model), and <span class="math inline">\(a\)</span> is a scaling factor applied to the range such that it’s value approaches unity at <span class="math inline">\(r\)</span>; Below are examples with <span class="math inline">\(a\approx 5\)</span>:</p>
<p><img src="rdrr_files/figure-html/fcasc-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Special conditions are set for <span class="math inline">\(f_\text{casc}\)</span>: All stream cells have <span class="math inline">\(f_\text{casc}=1\)</span>, meaning that the the mobile water store remains 100% mobile. Here <span class="math inline">\(b_\text{casc}=1\)</span>.</p>
</div>
<div id="groundwater-recharge" class="section level4">
<h4>groundwater recharge</h4>
<p>Groundwater recharge at cell <span class="math inline">\(i\)</span> is computed as:</p>
<p><span class="math display">\[
  g=\min\left(S_h,K_\text{sat}\Delta t\right)+S_k^+\left[1-\exp\left(-\frac{K_\text{sat}}{L}\Delta t\right)\right].
\]</span></p>
<p>It is important that the second term of the groundwater recharge equation remain… <strong>blah blah cascade towers</strong>. Here the interface length <span class="math inline">\(L\)</span>=10cm globally.</p>
</div>
</div>
<div id="parameters-1" class="section level3">
<h3>Parameters</h3>
<div id="globally-applied-cell-base-parameters" class="section level4">
<h4>globally applied, cell-base parameters</h4>
<ul>
<li><span class="math inline">\(D_\text{inc}\)</span>: depth of incised channel relative to cell elevation [m] (note, while it is possibile to assing this parameter on a cell basis, it was treated here as a global “tuning” parameter.)</li>
<li><span class="math inline">\(f_\text{casc}\)</span>: cascade fractions are based on a pre-determined relationship with local gradients.</li>
</ul>
</div>
<div id="regional-sub-watershed-based" class="section level4">
<h4>regional (sub-watershed based)</h4>
<ul>
<li><span class="math inline">\(m\)</span>: TOPMODEL groundwater scaling factor [m]</li>
</ul>
</div>
<div id="land-use-based" class="section level4">
<h4>land use based</h4>
<ul>
<li><span class="math inline">\(F_\text{imp}\)</span>: fraction of impervious cover</li>
<li><span class="math inline">\(F_\text{can}\)</span>: fraction of canopy cover</li>
<li><span class="math inline">\(\phi\)</span>: porosity</li>
<li><span class="math inline">\(F_c\)</span>: field capacity</li>
<li><span class="math inline">\(d_\text{ext}\)</span>: extinction depth of soil, where evapotranspiration cease to occur.</li>
</ul>
</div>
<div id="surficial-geology-based" class="section level4">
<h4>surficial geology based</h4>
<ul>
<li><span class="math inline">\(K_\text{sat}\)</span>: hydraulic conductivity as saturation</li>
</ul>
</div>
</div>
</div>
<div id="glossary" class="section level2">
<h2>Glossary</h2>
<ul>
<li><p>masl - metres above sea level</p></li>
<li><p>ECCC - Environment Canada and Climate Change</p></li>
<li><p>atmospheric yeild: term used to describe water (in liquid form) that is actively altering the hydrologic state at a particular location.</p></li>
</ul>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Beven, K.J.; Kirkby, M. J. (1979). “A physically based, variable contributing area model of basin hydrology”. Hydrological Science Bulletin. 24 (1): 43–69. <a href="doi:10.1080/02626667909491834" class="uri">doi:10.1080/02626667909491834</a></p>
<p>Garbrecht Martz 1997 The assignment of drainage direction over flat surfaces in raster digital elevation models</p>
<p>Gupta etal 2009 Decomposition of the mean squared error and NSE performance criteria- Implications for improving hydrological modelling</p>
<p>Monteith, J.L., 1965. Evaporation and environment. Symposia of the Society for Experimental Biology 19: 205–224.</p>
<p>National Operational Hydrologic Remote Sensing Center. 2004. Snow Data Assimilation System (SNODAS) Data Products at NSIDC, Version 1. [Indicate subset used]. Boulder, Colorado USA. NSIDC: National Snow and Ice Data Center. doi: <a href="https://doi.org/10.7265/N5TB14TC" class="uri">https://doi.org/10.7265/N5TB14TC</a>. [Date Accessed]</p>
<p>Ontario Ministry of Natural Resources and Forestry, 2015. GTA DEM 2002 User Guide. Queen’s Printer for Ontario. 14pp.</p>
<p>Penman, H.L., 1948. Natural evaporation from open water, bare soil and grass. Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences 193(1032): 120-145.</p>
<p>Wang, L., H. Liu, 2006. An efficient method for identifying and filling surface depressions in digital elevation models for hydrologic analysis and modelling. International Journal of Geographical Information Science 20(2): 193-213.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
